# content.md — データ・コンテンツ定義

---

## データソース

### 一次データ: 環境省 自治体排出量カルテ

- **URL**: https://policies.env.go.jp/policy/roadmap/local_keikaku/kuiki/karte.html
- **形式**: Excelファイル（自治体ごと）
- **URL パターン**: `https://policies.env.go.jp/.../xlsx/{団体コード}.xlsx`
- **対象自治体数**: 約1,900自治体（全国）
- **年度範囲**: 2009–2022年度（最新）
- **更新頻度**: 年1回

### 補助データ: 人口・面積

**人口データ** - 総務省統計局
- **出典**: 「統計でみる市区町村のすがた2022」表A（人口・世帯）
- **URL**: https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&lid=000001294138
- **基準日**: 2020年（住民基本台帳人口）
- **形式**: Excel（.xls）

**面積データ** - 国土地理院
- **出典**: 「統計でみる市区町村のすがた2022」表B（自然環境）
- **URL**: 同上
- **基準日**: 2020年10月1日
- **形式**: Excel（.xls）
- **単位**: km²（総面積）

### Excel ファイル構造

シート名: `データシート1`

| 行 | 内容 |
|---|---|
| 1行目 | ヘッダー（年度列） |
| 2行目〜 | 部門別排出量（千t-CO₂） |

**部門一覧**（行名）:
```
製造業
建設業
農林水産業
業務その他
家庭
旅客
貨物
鉄道
船舶
廃棄物
```

**年度列**: 2009, 2010, 2011, ..., 2022

---

## 都道府県・自治体 識別子

### 団体コード（環境省準拠）
- 5桁の数字
- 例: 東京都 = `13000`, 西東京市 = `13229`

### スラッグ（URL用）
- 都道府県: ローマ字小文字（`tokyo`, `osaka`）
- 自治体: 団体コード（`13229`）

### 都道府県コード一覧（抜粋）
```
01 北海道  02 青森  03 岩手  04 宮城  05 秋田
06 山形  07 福島  08 茨城  09 栃木  10 群馬
11 埼玉  12 千葉  13 東京  14 神奈川  15 新潟
...
47 沖縄
```

---

## 東京都 62自治体リスト（Phase 1対象）

### 特別区（23区）
```
13101 千代田区    13102 中央区      13103 港区
13104 新宿区      13105 文京区      13106 台東区
13107 墨田区      13108 江東区      13109 品川区
13110 目黒区      13111 大田区      13112 世田谷区
13113 渋谷区      13114 中野区      13115 杉並区
13116 豊島区      13117 北区        13118 荒川区
13119 板橋区      13120 練馬区      13121 足立区
13122 葛飾区      13123 江戸川区
```

### 多摩地域（26市）
```
13201 八王子市    13202 立川市      13203 武蔵野市
13204 三鷹市      13205 青梅市      13206 府中市
13207 昭島市      13208 調布市      13209 町田市
13210 小金井市    13211 小平市      13212 日野市
13213 東村山市    13214 国分寺市    13215 国立市
13218 福生市      13220 狛江市      13221 東大和市
13222 清瀬市      13223 東久留米市  13224 武蔵村山市
13225 多摩市      13226 稲城市      13228 羽村市
13229 西東京市
```

### 西多摩郡・島しょ部 等
```
13303 瑞穂町      13305 日の出町    13307 檜原村
13308 奥多摩町
13361 大島町      13362 利島村      13363 新島村
13364 神津島村    13381 三宅村      13382 御蔵島村
13401 八丈町      13402 青ヶ島村
13421 小笠原村
```

---

## KPI計算ロジック

### 実績ペース（annual_reduction_rate）
```python
import numpy as np

def calc_actual_pace(df, base_year=2013, latest_year=2022):
    """年平均削減率（%/年）"""
    base = df[base_year].sum()      # 全部門合計
    latest = df[latest_year].sum()
    years = latest_year - base_year
    # 年複利換算
    rate = (1 - (latest / base) ** (1 / years)) * 100
    return round(rate, 2)
```

### 必要ペース（required_pace）
```python
def calc_required_pace(base_emission, target_reduction_rate=0.46,
                        base_year=2013, target_year=2030):
    """2030年目標達成に必要な年平均削減率（%/年）"""
    target_emission = base_emission * (1 - target_reduction_rate)
    years = target_year - base_year  # 17年
    rate = (1 - (target_emission / base_emission) ** (1 / years)) * 100
    return round(rate, 2)
    # → 約 3.5%/年（▼46% / 17年）
```

### ペース達成率（pace_achievement_rate）
```python
def calc_pace_rate(actual_pace, required_pace):
    return round(actual_pace / required_pace * 100, 1)
```

### 2030年 予測不足量
```python
def calc_shortfall(base_emission, actual_pace, base_year=2013, target_year=2030):
    target = base_emission * (1 - 0.46)
    years = target_year - base_year
    forecast = base_emission * (1 - actual_pace/100) ** years
    return max(0, round(forecast - target, 1))  # 千t-CO₂
```

### 偏差値
```python
def calc_deviation(values, target_value):
    """同規模グループ内での偏差値（平均50・SD10）"""
    mean = np.mean(values)
    std = np.std(values)
    if std == 0:
        return 50
    return round(50 + 10 * (target_value - mean) / std, 1)
```

---

## サンプルデータ（西東京市 13229）

### 部門別排出量（千t-CO₂）

| 部門 | 2009 | 2013 | 2018 | 2022 | 2013比削減率 |
|---|---|---|---|---|---|
| 家庭 | 215 | 208 | 182 | 178 | ▼14.4% |
| 業務その他 | 228 | 224 | 178 | 155 | ▼30.8% |
| 旅客 | 138 | 137 | 120 | 111 | ▼19.0% |
| 製造業 | 120 | 120 | 77 | 67 | ▼44.2% |
| 廃棄物 | 38 | 36 | 31 | 28 | ▼22.2% |
| その他 | 17 | 13 | 14 | 15 | +15.4% |
| **合計** | **756** | **738** | **602** | **554** | **▼24.9%** |

### KPI値
```
総排出量（2022）: 554 千t-CO₂
削減率（2013比）: ▼26.7%  ※データシート値
実績ペース:       ▼2.4 %/年
必要ペース:       ▼3.2 %/年（国目標▼46%ベース）
ペース達成率:     75%
ペースステータス: at-risk
2030年予測不足量: 146 千t-CO₂
偏差値:           52（東京都内同規模比）
都内ランキング:   3位 / 62自治体
```

---

## ゼロカーボン宣言データ（Phase 2）

- **出典**: 環境省「地球温暖化対策推進法に基づく地方公共団体実行計画」
- **URL**: https://www.env.go.jp/policy/local_keikaku/
- **取得方法**: ページスクレイピング（APIなし）
- **データ項目**: 自治体名・宣言年月・2030目標値・2050目標

---

## コンテンツ文言ガイドライン

### 評価メッセージのトーン
- ❌ 「この自治体は気候変動対策に消極的です」（断定・批判）
- ❌ 「ゼロカーボン達成は絶望的」（煽り）
- ✅ 「現在のペースでは2030年目標に届きません」（事実の陳述）
- ✅ 「必要ペースの75%を達成しています」（相対的事実）

### 数値表示ルール
- 削減率: 小数点1桁（例: ▼26.7%）
- ペース: 小数点1桁（例: ▼2.4%/年）
- 排出量: 千t単位で整数（例: 554千t）、百万t以上は百万t単位（例: 43.2百万t）
- 偏差値: 整数（例: 52）

### 基準年の表記
- 「2013年度比」または「2013年度（パリ協定基準）比」
- 短縮形: 「2013比」
